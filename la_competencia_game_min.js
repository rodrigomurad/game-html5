const luchadores=document.getElementById("luchadores"),drop_zone=document.getElementById("drop_zone"),texto_resultado=document.getElementById("texto_resultado"),fighter_seleccionado=document.getElementById("fighter_seleccionado"),nombre_luchador_usuario=document.getElementById("nombre_luchador_usuario");let energiaFighterUsuario,energiaFighterPC,energiaPivote,puntaje_usuario,puntaje_PC,anio,mes,dia,tiempo,nombresluchadores=["earthak","firex","waterhit"],seleccionado=!1,ls=window.localStorage;window.player=prompt("Ingrese su Nombre"),localStorage.setItem("player",window.player),console.log("Player: ",window.player),window.player=localStorage.getItem("player"),void 0!==window.player&&null!=window.player&&"null"!==window.player||(window.player="PLAYER INEXISTENTE",localStorage.setItem("player",window.player));var ws=new WebSocket("wss://gamehubmanager.azurewebsites.net/ws");function rankingGenerate(e){var t=document.getElementById("rankingTableBody");t.innerHTML="",e.forEach((function(e,n){var o=document.createElement("tr"),r=document.createElement("td"),a=document.createElement("td"),i=document.createElement("td");console.log(e),r.textContent=n+1,a.textContent=e.Player,i.textContent=e.Value,o.appendChild(r),o.appendChild(a),o.appendChild(i),t.appendChild(o)}))}function handleOrientation(e){e.alpha;const t=e.beta,n=e.gamma;if(t<30&&0==seleccionado?(console.log("Waterhit"),fighter_seleccionado.src=document.getElementById("Waterhit").src,nombre_luchador_usuario.innerText="Waterhit",energiaFighterUsuario=2,seleccionado=!0):n<-40&&0==seleccionado?(console.log("Firex"),fighter_seleccionado.src=document.getElementById("Firex").src,nombre_luchador_usuario.innerText="Firex",energiaFighterUsuario=1,seleccionado=!0):n>40&&0==seleccionado&&(console.log("Earthak"),fighter_seleccionado.src=document.getElementById("Earthak").src,nombre_luchador_usuario.innerText="Earthak",energiaFighterUsuario=0,seleccionado=!0),t>=30&&n>=-40&&n<=40&&(fighter_seleccionado.src="",nombre_luchador_usuario.innerText="",document.getElementById("nombre_luchador_PC").innerText="",document.getElementById("fighter_PC").src="",seleccionado=!1),1==seleccionado){energiaFighterPC=parseInt(30*Math.random()/10),nombreFighterPC=nombresluchadores[energiaFighterPC],document.getElementById("nombre_luchador_PC").innerText=nombreFighterPC,document.getElementById("fighter_PC").src="img/fighter_"+nombreFighterPC+".png",energiaFighterUsuario==energiaFighterPC?(texto_resultado.style.color="#333",texto_resultado.innerText="empate"):((2==energiaFighterUsuario&&0==energiaFighterPC||0==energiaFighterUsuario&&2==energiaFighterPC)&&(energiaPivote=energiaFighterUsuario,energiaFighterUsuario=energiaFighterPC,energiaFighterPC=energiaPivote),energiaFighterUsuario-energiaFighterPC<0?(texto_resultado.style.color="#f00",texto_resultado.innerText="Perdiste",puntaje_PC++):(texto_resultado.style.color="#00f",texto_resultado.innerText="Ganaste",puntaje_usuario++)),document.getElementById("puntaje_usuario").innerText=puntaje_usuario,document.getElementById("puntaje_PC").innerText=puntaje_PC,seleccionado=!1,ls.setItem("Resultado",texto_resultado.innerText);var o={game:"La Competencia",event:"posicion",player:window.player,value:puntaje_usuario-1};o.value=o.value+1,ws.send(JSON.stringify(o))}}function replay(){seleccionado=!1,puntaje_usuario=0,puntaje_PC=0,document.getElementById("nombre_luchador_usuario").innerText="READY",document.getElementById("puntaje_usuario").innerText="0",document.getElementById("nombre_luchador_PC").innerText="READY",document.getElementById("puntaje_PC").innerText="0",texto_resultado.innerText="",fighter_seleccionado.src="",document.getElementById("fighter_PC").src=""}ws.addEventListener("open",(function(e){console.log("Conectado!")})),ws.addEventListener("message",(function(e){console.log("Mensaje recibido: ",e.data);var t=JSON.parse(e.data);console.log(t),rankingGenerate(JSON.parse(t))})),window.addEventListener("deviceorientation",handleOrientation);